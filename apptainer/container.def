Bootstrap: localimage
From: apptainer/base.sif

%help
	Apptainer definition file example to be used with `build_container.sh`, `shell_container.sh` and `hpc.sh`.

%labels
	Author p.templier@imperial.ac.uk

%files
	./ /workdir

%post
    cd /workdir
    ls -a

    rm -rf build
    mkdir build
    cd build

    cmake .. -DCMAKE_BUILD_TYPE:STRING=Release -G Ninja -DCMAKE_C_COMPILER:STRING=clang-12 -DCMAKE_CXX_COMPILER:STRING=clang++-12 -DMJPC_BUILD_GRPC_SERVICE:BOOL=ON

    cmake --build . --config=Release


%runscript
	# Run main
	cd bin
    ./mjpc
