<mujoco model="Moving Crane">
  <include file="../common.xml"/>
  <include file="crane_free_joint_copy.xml" />
  <!-- include file="prismatic_crane_4ft_double_pendulum_ball_joint.xml" / -->
  <!-- include file="no_platform_with_prismatic_crane_analytical_hinges_4ft.xml" / -->


  <!-- set userdata =model.nv+model.nq for storeing qpos and qvel from ROS-->
  <!-- add three more userdata for payload tip x, y z acc, i.e. 14+3 -->
  <size memory="1M" nuserdata="17"/>

  <custom>
    <!-- agent -->
    <numeric name="agent_planner" data="0" />
    <numeric name="agent_horizon" data="0.9" /> <!-- 0.0625-->
    <numeric name="agent_timestep" data="0.004" />
    <numeric name="agent_policy_width" data="0.0035" />
    <numeric name="sampling_spline_points" data="6" />
    <numeric name="sampling_exploration" data="0.1" />
    <numeric name="sampling_trajectories" data="30" />
    <numeric name="sampling_representation" data="0" />
    <!-- parameter -->
    <numeric name="residual_ViconX" data="1.12 -1.5 1.5" />
    <numeric name="residual_ViconY" data="0 -1.5 1.5" />
    <numeric name="residual_ViconZ" data="0.936 0.0 2.0" />
    <numeric name="residual_GoalX" data="0.8 -2 2" />
    <numeric name="residual_GoalY" data="0.4 -2 2" />
    <numeric name="residual_GoalZ" data="0.6 0.0 2" />
    <numeric name="residual_select_Modify State" data="0"/> <!-- toggle button for modify state-->
    <text name="residual_list_Modify State" data="No|Yes"/>
    <!-- estimator -->
    <!-- cause serious rollout divergence -->
    <numeric name="estimator" data="0" />
    <numeric name="estimator_sensor_start" data="4" />
    <numeric name="estimator_number_sensor" data="3" />
    <numeric name="estimator_timestep" data="0.004" />
    <!-- numeric name="batch_configuration_length" data="3" />
    <numeric name="batch_scale_prior" data="1.0e-3" / -->

  </custom>

  <worldbody>

    <!-- define a yellow target for crane's payload to follow -->
    <body name="target" mocap="true" pos="1.5 0 0.5">
      <geom name="target" type="sphere" size="0.04" rgba="0 0 1 1"/>
    </body>
    
  </worldbody>

  <contact>
        <exclude name="target_hit_paylaod" body1="target" body2="payload"/>
        <!-- exclude name="target_hit_paylaod_connector" body1="target" body2="payload_connector"/ -->
        <exclude name="target_hit_boom" body1="target" body2="boom"/>

  </contact>

  <sensor>
    <!-- cost -->
    <user name="Distance" dim="1" user="2 600 0 1000 0.04" />
    <user name="Sway_Angle" dim="1" user="2 1500 500 5000 0.04"/>
     <user name="KE" dim="1" user="2 6000 3000 10000 0.04"/>
    <user name="Control" dim="2" user="0 0.01 0.0 1.0"/>  
    <!-- acceleration is too fuzzy and causes blow up of cost values-->
    <!-- user name="Payload_Acc" dim="3" user="0 1000 1000 10000"/ -->

    <!-- estimator -->
    <jointpos name="4" joint="hoist-slider"/>
    <jointvel name="5" joint="p-tip-eta-hinge"/>
    <jointvel name="6" joint="p-tip-sigma-hinge"/>

    <!-- trace -->
    <framepos name="trace0" objtype="site" objname="p_cg"/>

    <!-- residual -->
    <force name="btip_force"  site="b_tip"/>
    <force name="btip_torque"  site="b_tip"/>
    <framepos name="b_tip_pos" objtype="site" objname="b_tip"/>
    <framelinvel name="boom_vel" objtype="site" objname="b_tip"/>
    <framequat name="b_tip_quat" objtype="site" objname="p_cg"/>
    <framepos name="p_pos" objtype="site" objname="p_cg"/>
    <framepos name="p_tip" objtype="site" objname="p_tip"/>
    <framelinacc name="p_acc" objtype="body" objname="payload"/> 
     
  </sensor>

</mujoco>

